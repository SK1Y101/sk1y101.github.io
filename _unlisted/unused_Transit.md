
#### Transit fitting

Transit fits were then performed on the de-trended data, using the Juliet wrapper to both the Batman <d-cite key="batman"></d-cite>and Dynesty <d-cite key="dynesty"></d-cite> packages. The parameters for the transit models are initialised by randomly selecting from the priors, and iteratively walked through parameter space. The general parameters for the exoplanet are returned to the posteriors of the fit, which adequately match the confirmed literature despite having few transits and no initial parameters to work from.

{% capture tab_hats46b %}{% increment transit_table_num %}{% endcapture %}
Taking the posteriors found for HATS-46b, as compared to the detection paper <d-cite key="hats46b"></d-cite>, we have the results as given in table <fig>[{{ tab_hats46b }}]</fig>


##### Juliet-Literature comparison

| Tables        | Are           | Cool  |
| ------------- |:-------------:| -----:|
| col 3 is      | right-aligned | $1600 |
| col 2 is      | centered      |   $12 |
| zebra stripes | are neat      |    $1 |

<!-- | Source          | <d-cite key="hats46b"></d-cite>      | Juliet posteriors |
|:--------------- |:------------------------------------:|:-----------------:|
| $$ a / R_* $$ | $$ \errorvalue{13.55}{0.45}{0.65} $$ | $$ \errorvalue{14.699}{1.541}{1.830} $$ |
| $$ b $$ | $$ \errorvalue{0.63}{0.042}{0.034} $$ | $$ \errorvalue{0.480}{0.266}{0.171}  $$ |
| $$ i $$ | $$ \errorvalue{87.32}{0.22}{0.31} $$ | $$ \errorvalue{88.126}{1.119}{1.014} $$  |
| $$ R_p / R_* $$ | $$ 0.1088 \pm 0.0027 $$ | $$ \errorvalue{0.10369}{0.00496}{0.00444}  $$ |
| $$ P $$ | $$ 4.7423729 \pm 0.0000049 $$ | $$ \errorvalue{4.7423836070}{0.0000139110}{0.0000114410} $$ |
<div class="caption">
    Table {{ tab_hats46b }}. Comparison between literature parameters and Juliet parameters from <em>TESS</em> for HATS-46b. Many of the values satisfy the "Good enough" criterion despite not having the complementary radial velocity measurements used in the detection paper to refine the parameters.
</div> -->

\subsubsection{TTV Residuals}

By subtracting the found transit times from computed ephemerides, TTV residuals are computed for each transit. The transit uncertainty is read directly from the Juliet posteriors, and can be seen in the bottom half of figures \ref{fig_hats46tess}, and \ref{fig_Wasp8tess}.

The uncertainty in the residuals are proportional to the depth of the transit divided by the variance in the data, as seen in the two provided figures. From this, we would expect the magnitude and standard deviation of TTV to be approximately the same order of magnitude. Of particular note in that regard are the Wasp-8 TTV residuals: all of them lie more than one sigma from the centre of the O-C diagram.

\subsection{Simulation pipeline}

\subsubsection{Initialisation}
The simulation pipeline makes use of the REBOUND <d-cite key="rebound"></d-cite> and REBOUNDx <d-cite key="reboundx"></d-cite> packages for numerical integration. The pipeline has been created to accept either a given planetary system, as seen in figure \ref{fig_trappistlayout}, or a $.csv$ file holding orbital elements.

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/TRAPPIST-1_layout}
    \caption[TRAPPIST-1 System Layout]{system layout as generated by the simulation pipeline for TRAPPIST-1.}
    \label{fig_trappistlayout}
\end{figure}

The system is set up from provided parameters, and iterated forward using IAS15 <d-cite key="reboundias15"></d-cite>. Transits are evaluated where the position of the star, $\hat{R_*}$, and position of the target, $\hat{R_T}$, satisfy the following,

\begin{equation}
    \hat{R}_*.y < \hat{R}_T.y
\end{equation}\vspace{-0.75cm}
\begin{equation}
    \hat{R}_*.x \approx \hat{R}_T.x
\end{equation}

\subsubsection{Simulated TTV}
The transit time is found by iteratively decreasing simulation step time, and integrating until the desired precision is met, which is 1 millisecond by default. This provides a set of simulated transit times which are fit to TTV using least squares regression as mentioned in section \ref{lsq}. In the case of TRAPPIST-1b, the simulation output is as seen in figure \ref{fig_trappistTTV}.

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/TTVSimulation_trappist-1b}
    \caption[TRAPPIST-1b simulated TTV]{TTV Residuals for TRAPPIST-1b according to simulation. Note the complex sinusoidal motion and large magnitudes due to the highly-resonant nature of the system. Additionally, note the thickness of the TTV curve, caused by low period variations due to non-resonant interactions. }
    \label{fig_trappistTTV}
\end{figure}

The simulation pipeline integrates the effect of General Relativity, but could be further extended to include effects such as tidal deformation, stellar evolution, to even those as subtle as the Yarkovsky effect.

\subsection{Analytical Models}

Following the derivations in section \ref{ttvmodels}, analytical models were converted to vectorisable code to be executed by the computation pipeline. The translation from equation to code is mostly intuitive, and can be seen in this project's GitHub repo,  \hyperlink{https://github.com/SK1Y101/TransitProject}{https://github.com/SK1Y101/TransitProject}.

\subsubsection{System and TTV}

To demonstrate the capabilities of the model, we selected exoplanetary systems with known TTV signals and generated synthetic systems whose properties were representative of the real systems, to allow precise control of TTV magnitude during testing phases. An example system layout is given in figure \ref{fig_examplelayout}.

Running the TTV simulation over a timescale of 200 years gives the residuals seen in figure \ref{fig_exampleTTVSim}. A 200-year integration is not representative of any known transiting planet, the earliest transiting data dates to 1999 <d-cite key="firstTransit"></d-cite>, and was simply chosen to better demonstrate the long-term evolution of the transit timing variation. The variance of data returned by the simulation is the standard deviation of measured TTV. For real systems, however, this variance is computed from the uncertainties of known parameters.

The initial parameters used in this synthetic system are given in table \ref{tab_systemparams}.

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/example_system_layout}
    \caption[System layout for one of the synthetic systems]{The system layout for one of the synthetic test systems. The exoplanets in this example were initialised in low-eccentricity non-resonant orbits, with masses of 0.8, 0.5, and 5 Jupiter mass from inner to outer.}
    \label{fig_examplelayout}
\end{figure}

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/TTVSimulation_transiting_planet}
    \caption[TTV Residuals for the synthetic system]{Simulated TTV residuals for the synthetic system used in model testing. The TTV simulated are for the outermost planet in the system, as seen in figure \ref{fig_examplelayout}.}
    \label{fig_exampleTTVSim}
\end{figure}

\begin{table}
	\centering
	\begin{tabular}{lccccc} % four columns, alignment for each
	    \multicolumn{5}{c}{Initialisation parameters} \\
		\hline
		Body        | $m$            | $p$ (Days) | $e$    | $\omega$ (Radians) \\
		\hline
		Star        | $1.32 M_\odot$ |            |        |           \\
		Perturber 1 | $0.8 M_J$      | $9$        | $0.15$ | $0$       \\
		Perturber 2 | $0.5 M_J$      | $65$       | $0.15$ | $1$       \\
		Target      | $5 M_J$        | $537$      | $0.30$ | $\pi / 2$ \\
		\hline
	\end{tabular}
	\caption[Synthetic system parameters]{Initial parameters for the synthetic system: mass, orbital period, eccentricity, and argument of periapsis. Other parameters not given here are initialised to zero, or (in the case of $a$, computed in-situ).}
	\label{tab_systemparams}
\end{table}

\subsubsection{Model comparison}

To determine the validity of the analytical models, they were executed with the initial parameters used to set up the system. As the transiting planet is the outermost in the system, the first class of TTV models \ref{classone} is used to analytically approximate the system. The models as derived in this paper are given in equations \ref{eq_ttvbarycentre}, \ref{eq_partialeccentricity}, and \ref{eq_TTVeccentric}, which are re-summarised below,

\begin{equation}
    \delta_T = -\frac{P_T}{2 \pi a_T}\sum_i^n \left[ a_i \mu_i \sin \frac{2 \pi \left(t - t_{0,i} \right)}{P_i}\right]
\end{equation}

\begin{equation}
    \delta_T = -\frac{P_T}{2 \pi a_T}\sum_i^n \left[ a_i \mu_i \frac{1 - e_i^2}{1 + e_i \cos f_i} \sin \left(f_i + \omega_i\right) \right]
\end{equation}

\begin{equation}
\delta_T = -\frac{P_T}{2 \pi a_T}\left(\frac{1 - e_T^2}{1 + 2 e_T \cos f_T + e_T^2}\right)^\frac{1}{2} \cdot\sum_i^n \left[ a_i \mu_i \frac{1 - e_i^2}{1 + e_i \cos f_i} \sin \left(f_i + \omega_i\right) \right]
\end{equation}

The TTV curves generated by these models are shown in figure \ref{fig_testmodelcomparisonold}. Despite the various approximations used in the derivation for each model, and the subsequent applicability space for which they are valid, they match the simulated TTV to within the 1-sigma bounds.

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/TTVTestModelComparisonold}
    \caption[Analytical TTV given synthetic system initial parameters]{Analytical TTV curves for the synthetic system, using the initial parameters. Model1, Model2, and Model3 are the models described in equations \ref{eq_ttvbarycentre}, \ref{eq_partialeccentricity}, and \ref{eq_TTVeccentric} respectively. Each graph shows a 5 transit snippet from the TTV curve. Simulated TTV times are overlaid in black.}
    \label{fig_testmodelcomparisonold}
\end{figure}

Additionally, note how the overall shape of the analytical curves change as a result of first introducing perturbed eccentricity, and then transiting planet eccentricity. Strictly speaking, the sections of the analytical curves between each transit do not correspond to anything physically within the system. They describe the predicted TTV, were the transiting planet to have a slightly offset time of periapsis passage.

\subsubsection{Parameter optimisation}
As we have now demonstrated the accuracy of the models, to some set of initial parameters, the next stage is in the reverse: finding some parameters for which the model fits the data set.

To do this, the three models were each initialised with the fixed parameters, those being the properties of the host star and transiting planet, and three sets of arbitrary initial parameters corresponding to a system with one, two, and three planets additional to the transiting target, giving an effective set of 9 models to optimise. Each of these were optimised with both dual annealing <d-cite key="dualAnnealing"></d-cite> and differential evolution <d-cite key="diffEvo"></d-cite>, for which the best fit of the two methods was selected as that model's maximum likelihood solution.

The optimal TTV curves found for each model are given in figure \ref{fig_modelcurves}, where the table of the optimal solution values for each model is given in tables \ref{tab_1planetcorrectedfittingparameters}, \ref{tab_2planetcorrectedfittingparameters}, and \ref{tab_3planetcorrectedfittingparameters}.

\begin{table}
	\centering
	\begin{tabular}{llcccc}
	    \multicolumn{6}{c}{One perturbing planet} \\
		\hline
		Model | Method | $\mu$ ($10^{-6}$) | $a$ ($10^{-6}$ AU) | $e$ | $\omega$ \\
		\hline
		Model 1 |  diff. evo.  |  348.996 |  380017.037 |  0.245 |  6.083 \\
        Model 1 |    dual an.  |  612.062 |  216632.299 |  0.033 |  5.589 \\
        Model 2 |  diff. evo.  |  504.325 |  185229.581 |  0.344 |  2.018 \\
        Model 2 |    dual an.  |  321.476 |  419718.646 |  0.116 | -0.019 \\
        Model 3 |  diff. evo.  |  428.884 |  225677.205 |  0.043 | -4.821 \\
        Model 3 |    dual an.  |  625.847 |  158625.666 |  0.114 | -3.129 \\
		\hline
	\end{tabular}
	\caption{Best fit parameters for the synthetic system TTV with only a single perturbing planet.}
	\label{tab_1planetcorrectedfittingparameters}
\end{table}

\begin{table}
	\centering
	\begin{tabular}{llcccc}
	    \multicolumn{6}{c}{Two perturbing planets} \\
		\hline
		Model | Method | $\mu$ ($10^{-6}$) | $a$ ($10^{-6}$ AU) | $e$ | $\omega$ \\
		\hline
		Model 1 |  diff. evo.  |   75.484 |  1242571.08 |  0.239 | -0.864 \\
                |              |   41.269 |  135176.665 |  0.195 | -1.165 \\
        Model 1 |    dual an.  |  206.855 |  226389.639 |  0.463 | -6.241 \\
                |              |  227.427 |  585132.122 |  0.483 |  -2.24 \\
        Model 2 |  diff. evo.  |  398.235 |  118829.517 |  0.019 | -0.285 \\
                |              |  146.886 |  833966.926 |  0.135 |  1.518 \\
        Model 2 |    dual an.  |  268.507 |  500367.032 |  0.101 | -2.655 \\
                |              |  138.984 |   335523.36 |  0.142 |  1.404 \\
        Model 3 |  diff. evo.  |  427.237 |  225677.039 |    0.0 |  6.283 \\
                |              |    0.001 |   58070.523 |  0.085 |  4.119 \\
        Model 3 |    dual an.  |   35.051 |  995449.059 |  0.113 |   3.73 \\
                |              |  102.098 |  966847.114 |  0.082 |    2.8 \\
		\hline
	\end{tabular}
	\caption{Best fit parameters for the synthetic system TTV with two perturbing planets.}
	\label{tab_2planetcorrectedfittingparameters}
\end{table}

\begin{table}
	\centering
	\begin{tabular}{llcccc}
	    \multicolumn{6}{c}{Three perturbing planets} \\
		\hline
		Model | Method | $\mu$ ($10^{-6}$) | $a$ ($10^{-6}$ AU) | $e$ | $\omega$ \\
		\hline
		Model 1 |  diff. evo.  |  589.909 |  241886.321 |  0.386 | -2.961 \\
                |              |    7.508 |  263814.017 |  0.449 |  -5.18 \\
                |              |   53.287 |  236535.741 |  0.009 |  0.337 \\
        Model 1 |    dual an.  |   19.684 |  1411636.58 |  0.205 |   3.55 \\
                |              |   196.18 |  240995.442 |  0.354 |  0.185 \\
                |              |  428.518 |  310462.859 |  0.059 | -6.026 \\
        Model 2 |  diff. evo.  |  145.253 |  833960.172 |  0.262 |  2.613 \\
                |              |    0.001 |  134746.642 |  0.288 |  -3.71 \\
                |              |  103.699 |  109160.755 |  0.142 | -1.761 \\
        Model 2 |    dual an.  |  286.502 |   167374.87 |   0.14 |  2.521 \\
                |              |  625.306 |  212912.077 |  0.001 | -4.735 \\
                |              |  471.528 |   67248.984 |  0.434 |  0.301 \\
        Model 3 |  diff. evo.  |     5.06 |  216218.273 |  0.311 |  1.451 \\
                |              |    18.73 |   240838.21 |  0.309 |  4.963 \\
                |              |  616.988 |  100349.363 |  0.021 | -4.403 \\
        Model 3 |    dual an.  |    78.76 |  1242718.32 |  0.012 |   2.37 \\
                |              |   123.85 |  281959.982 |  0.192 | -4.953 \\
                |              |   602.58 |   95865.617 |    0.5 |  1.574 \\
		\hline
	\end{tabular}
	\caption[Best fit parameters for models for the synthetic system]{Best fit parameters for the synthetic system TTV with three perturbing planets.}
	\label{tab_3planetcorrectedfittingparameters}
\end{table}

\begin{figure}
    \centering
	\includegraphics[width=.89\columnwidth]{Images/TTVTestModelFitting}
    \caption[Best fit curves for the 18 models with the synthetic data set]{Fit TTV curves from the set of 18 models after being optimised with the synthetic system.}
    \label{fig_modelcurves}
\end{figure}

\subsubsection{Model selection}

How a model is selected as most likely is two-fold. To begin with, we sample the solutions for each model to determine marginalisation and uncertainties. The parameter space is sampled using MCMC <d-cite key="emcee"></d-cite>, and a normal parameter distribution constructed from the sampler. This is then converted to a set of quantiles, specifically $16\%$, $50\%$, and $84\%$, representing the reportable parameters and one sigma variance. The entire normal distribution is reported in a corner plot using the corner package <d-cite key="corner"></d-cite>.

With the set of best fit parameters and error bounds for each model, the accuracy of their fit is determined by scoring with the three information criterion discussed earlier: AIC <d-cite key="AIC"></d-cite>, <d-cite key="AIC2"></d-cite>, AICc <d-cite key="AICC"></d-cite>, and BIC <d-cite key="BIC"></d-cite>. The information criterion values for each model for this data is given in table \ref{tab_informationCriterion}

\begin{table}
	\centering
	\begin{tabular}{llccccc}
	    \multicolumn{6}{c}{Information criterion} \\
		\hline
		Model | Method | $k$ | $AIC$ | $AICc$ | $BIC$ \\
		\hline
		Model 1 |  diff. evo.  |  4 |  1430.588159 |  1430.961991 |  1441.462154 \\
        Model 1 |    dual an.  |  4 |  1430.953796 |  1431.327627 |  1441.827791 \\
        Model 1 |  diff. evo.  |  7 |  1642.175578 |  1643.252501 |   1661.20507 \\
        Model 1 |    dual an.  |  7 |  1606.839154 |  1607.916077 |  1625.868646 \\
        Model 1 |  diff. evo.  | 10 |  1460.812691 |  1462.990909 |   1487.99768 \\
        Model 1 |    dual an.  | 10 |  1512.057709 |  1514.235926 |  1539.242697 \\
        Model 2 |  diff. evo.  |  5 |  1465.179736 |  1465.745774 |  1478.772231 \\
        Model 2 |    dual an.  |  5 |  1464.585283 |  1465.151321 |  1478.177777 \\
        Model 2 |  diff. evo.  |  9 |  1452.463533 |  1454.228239 |  1476.930023 \\
        Model 2 |    dual an.  |  9 |  1454.402606 |  1456.167312 |  1478.869096 \\
        Model 2 |  diff. evo.  | 13 |  1472.298081 |  1476.012367 |  1507.638567 \\
        Model 2 |    dual an.  | 13 |  1727.322675 |   1731.03696 |   1762.66316 \\
        Model 3 |  diff. evo.  |  5 |  1477.916183 |   1478.48222 |  1491.508677 \\
        Model 3 |    dual an.  |  5 |  1454.979605 |  1455.545643 |    1468.5721 \\
        Model 3 |  diff. evo.  |  9 |  1620.473796 |  1622.238502 |  1644.940286 \\
        Model 3 |    dual an.  |  9 |  1564.258843 |  1566.023549 |  1588.725333 \\
        Model 3 |  diff. evo.  | 13 |  1592.098363 |  1595.812649 |  1627.438849 \\
        Model 3 |    dual an.  | 13 |  1697.010862 |  1700.725148 |  1732.351348 \\
		\hline
	\end{tabular}
	\caption[Information criterion for fitting models for the synthetic system]{Free parameter count, maximum log likelihood, and information criterion scores for each of the 18 models. The number of data-points used was $112$, corresponding to a simulation time of around $200$ years.}
	\label{tab_informationCriterion}
\end{table}

\subsubsection{Most likely system}

We can determine the most likely model by selecting that with the lowest AIC, AICc, and BIC from the information criterion table \ref{tab_informationCriterion}. The parameters for the best fit model are given in table \ref{tab_bestfitparams}, with the initial system parameters also listed. Additionally, the corner plot for the best-fit model is given in figure \ref{fig_modelcorner}, and the system layout is given in figure \ref{fig_modelsystemlayout}. As a comparison, the second-bet fit model parameters are also listed in figure \ref{tab_bestfitparams}, with the system layout given in \ref{fig_modelsystemlayout2}.

\begin{table}
	\centering
	\begin{tabular}{lccc}
	    \multicolumn{4}{c}{Initial-`best fit' parameters} \\
		\hline
		Source | Initial  | best-fit | second-contender \\
		\hline
		perturbers        | 2          | 1                                       | 2 \\
		$\mu$ $(10^{-6})$ | 763.834    | \errorvalue{347.104}{42.043}{36.969}    |  \errorvalue{307.455}{266.399}{179.331} \\
		                  | 477.396    |                                         |  \errorvalue{142.286}{66.645}{39.806} \\
		$a$ $(10^{-6})$   | 902905.881 | \errorvalue{380015.561}{22.941}{21.390} |  \errorvalue{118936.225}{6823.023}{65818.750} \\
		                  | 347103.538 |                                         |  \errorvalue{833957.621}{144.770}{192.663} \\
		$p$ Days          | 65.002     | \errorvalue{74.471}{0.007}{0.006}       |  \errorvalue{13.040}{1.002}{9.002} \\
		                  | 8.999      |                                         |  \errorvalue{242.119}{0.058}{0.081} \\
		$e$               | 0.15       | \errorvalue{0.245}{0.159}{0.170}        |  \errorvalue{0.019}{0.000}{0.220} \\
		                  | 0.15       |                                         |  \errorvalue{0.135}{0.080}{0.002} \\
		$\omega$          | 1          | \errorvalue{1.082}{5.132}{4.661}        |  \errorvalue{-0.285}{0.826}{0.0368} \\
		                  | 0          |                                         |  \errorvalue{1.518}{0.593}{0.013} \\
		\hline
	\end{tabular}
	\caption[Comparison between best fit and initial parameters for the synthetic system]{Comparison of the found parameters, with uncertainties, and the initial parameters used for system setup. The periods are computed from the semimajor axes, and each planet is given its own row. Model 1 with a single perturber produced the best fit parameter, while Model 2 with two perturbers produced the second-contender}
	\label{tab_bestfitparams}
\end{table}

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/TTVTestModelFittingCorner}
    \caption[Corner-plot for best-fit model output]{Sample corner plot for the best-fit model output. Along the diagonal is the normal distribution for each parameter, with the remainder filled out with two-dimensional slices of the parameter space. The \nth{16}, \nth{50}, and \nth{84} quantiles are marked with the dashed lines.}
    \label{fig_modelcorner}
\end{figure}

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/example_system_BestFitLayout}
    \caption[Best fit system layout]{System layout for the best-fit model parameters for the synthetic system. Note how the found planet roughly correlates to the second transiting planet in the system.}
    \label{fig_modelsystemlayout}
\end{figure}

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/ExampleSystem_SecondBestFitLayout}
    \caption[Second Best fit system layout]{System layout for the second-best-fit model parameters for the synthetic system. Note how both of the found planets have slightly larger orbits than the initial system layout in figure \ref{fig_examplelayout}, due to the lower $\mu$ found by the optimiser, as seen in table \ref{tab_bestfitparams}.}
    \label{fig_modelsystemlayout2}
\end{figure}

%A clear description of the results obtained needs to be provided in the context of previous state of the art, including advantages, and limits/errors. Summaries of important results should be included in tables and figures in the main text. Discuss the implications of the results obtained. What do the results mean? How well do the results obtained correspond with expectations? What can justifiably be deduced from the work carried out? What is the impact of the work?

\subsection{Discussion}

\subsubsection{Evaluation}

We have successfully demonstrated the accuracy of analytical transit timing variation models as compared to TTV signals, seen in figure \ref{fig_testmodelcomparisonold}, as well as the potential for this methodology to be applied to determining the parameters of TTV systems, seen in figure \ref{fig_modelsystemlayout}. We have also demonstrated the capabilities of our computational pipeline, and the possibilities for further work that could be implemented using it.

Therefore, although it has not yet been demonstrated for a known exoplanetary system, the method and computational pipeline outlined in this paper should be capable of producing similar results when using real transit timing variation data. Further study in this field would allow this to be proven, and further refinements should reduce the computational time required to perform each analysis.

\subsubsection{Limitations}\label{limitations}

One of the primary goals was the observation of exoplanetary transits, with six observation windows planned at the beginning of the project. One of those observations was severely hampered by cloud cover, and four others had to be cancelled.

While part of this project focused on finding the globally optimal solution, this does not necessarily always exist. Due to the highly chaotic nature of gravitational interactions, multiple systems layouts can provide identical or near identical TTV signals. This is best demonstrated in the detection paper for kepler-19c, see figure 14 in <d-cite key="Keplerc"></d-cite>, where a single TTV signal had no fewer than eight possible configurations for the orbit of an extra planet.

This demonstrates a possible drawback of this method, and would require additional constraints based on complementary observations for any tentative detections made using transit timing variations to be considered.

The best-fit for the synthetic system, given in table \ref{tab_bestfitparams}, gave only a single perturbing planet as the maximum likelihood, as opposed to the two that were used to initialise the simulation. This is due to the outer perturbing planet dominating the TTV signal, as seen in figure \ref{fig_exampleTTVSim}, due to its larger semi-major axis. This demonstrates the second drawback of this methodology, and ties into the statement about non-unique TTV solutions: the additional effect on TTV due to more than one perturber can become negligible.

This could be circumvented by fitting for a TTV cause to find the most dominant planetary effect, and then subtracting that from the known TTV signal. This would leave only the effects of other planets in the system, which could be fed back into the fitting pipeline to determine the parameters of the second perturber, and so on. This would, however, require a longer integration time for the computational pipeline.

As an additional point, we see the second-best fit given in table \ref{tab_bestfitparams} \textit{does} pick out the second planetary signal. The higher Akaike information criterion for this model is almost singularly decided by the model having 9 free parameters, as opposed to 4. Further research may benefit from re-evaluating the information criterion used. A disparity in our implementation may come from the assumptions made when determining the number of free parameters for each model: The original AIC assumed each free parameter contributed an additional polynomial power, while our paper assumed each orbital element contributed an additional free parameter.

\subsubsection{Errors}

A sample output was generated while writing this paper to show some problems associated with the TTV fitting pipeline during its development. For this broken state, Figure \ref{fig_testmodelfittingcomparisonold} shows the best-fit TTV curves generated by model 1, and tables \ref{tab_1planetfittingparameters}, \ref{tab_2planetfittingparameters}, and \ref{tab_3planetfittingparameters}, show the output parameters found.

\begin{table}
	\centering
	\begin{tabular}{llcccc}
	    \multicolumn{6}{c}{One perturbing planet with broken pipeline} \\
		\hline
		Model | Method | $\mu$ ($10^{-6}$) | $a$ ($10^{-6}$ AU) | $e$ | $\omega$ \\
		\hline
		Model 1 |  diff. evo.  |    1.035 |     96.079 |  0.328 |  5.544 \\
        Model 1 |    dual an.  |    6.705 |    492.195 |  0.247 |  4.653 \\
        Model 2 |  diff. evo.  |     1.87 |      16.48 |   0.05 | -1.199 \\
        Model 2 |    dual an.  |      0.0 |  1000000.0 |    0.0 | -6.283 \\
        Model 3 |  diff. evo.  |    7.159 |     25.489 |  0.721 |  0.331 \\
        Model 3 |    dual an.  |  230.674 |     32.877 |   0.95 | -1.076 \\
		\hline
	\end{tabular}
	\caption{Best fit parameters for the synthetic system TTV with only a single perturbing planet, generated with a version of the fitting pipeline that was not working correctly.}
	\label{tab_1planetfittingparameters}
\end{table}

\begin{table}
	\centering
	\begin{tabular}{llcccc}
	    \multicolumn{6}{c}{Two perturbing planets with broken pipeline} \\
		\hline
		Model | Method | $\mu$ ($10^{-6}$) | $a$ ($10^{-6}$ AU) | $e$ | $\omega$ \\
		\hline
		Model 1 |  diff. evo.  |      4.25 |      6.047 |  0.689 | -0.429 \\
                |              |     5.191 |      13.68 |  0.682 |  3.073 \\
        Model 1 |    dual an.  |   10000.0 |  1000000.0 |  0.089 |  3.107 \\
                |              |       0.0 |  1000000.0 |  0.168 |  3.556 \\
        Model 2 |  diff. evo.  |     8.378 |      5.079 |  0.334 | -4.329 \\
                |              |     3.081 |      3.842 |  0.315 |  3.798 \\
        Model 2 |    dual an.  |   142.003 |   1470.238 |  0.904 | -6.245 \\
                |              |   135.908 |    363.211 |  0.446 | -2.719 \\
        Model 3 |  diff. evo.  |     1.242 |     91.763 |  0.345 |  3.337 \\
                |              |    69.118 |       1.51 |  0.774 | -0.539 \\
        Model 3 |    dual an.  |  9566.976 |   1749.583 |  0.946 | -6.156 \\
                |              |    44.774 |  39782.621 |  0.021 | -1.303 \\
		\hline
	\end{tabular}
	\caption{Best fit parameters for the synthetic system TTV with two perturbing planets, generated with a version of the fitting pipeline that was not working correctly.}
	\label{tab_2planetfittingparameters}
\end{table}

\begin{table}
	\centering
	\begin{tabular}{llcccc}
	    \multicolumn{6}{c}{Three perturbing planets with broken pipeline} \\
		\hline
		Model | Method | $\mu$ ($10^{-6}$) | $a$ ($10^{-6}$ AU) | $e$ | $\omega$ \\
		\hline
		Model 1 |  diff. evo.  |     14.363 |       5.521 |  0.713 |  3.778 \\
                |              |     26.087 |        1.68 |   0.07 | -0.992 \\
                |              |     54.047 |       1.908 |  0.472 |  0.803 \\
        Model 1 |    dual an.  |    373.562 |    1019.304 |   0.09 |  4.129 \\
                |              |    460.821 |     3787.52 |   0.63 | -0.409 \\
                |              |    429.981 |    4730.766 |  0.856 |  5.576 \\
        Model 2 |  diff. evo.  |      0.031 |     651.633 |  0.438 |  1.067 \\
                |              |      3.066 |       8.581 |  0.609 |  1.124 \\
                |              |    667.252 |       0.164 |  0.076 | -1.809 \\
        Model 2 |    dual an.  |  10876.298 |   19380.767 |  0.948 |  0.079 \\
                |              |   2263.278 |  116193.389 |   0.91 | -0.201 \\
                |              |     52.942 |  199344.612 |   0.38 |  -3.02 \\
        Model 3 |  diff. evo.  |      0.933 |       5.807 |  0.346 |  1.041 \\
                |              |     13.972 |       0.649 |  0.606 |  5.087 \\
                |              |      0.0   |      25.101 |  0.786 | -0.541 \\
        Model 3 |    dual an.  |   1963.766 |   49260.785 |   0.95 |  -3.42 \\
                |              |   2002.719 |    33767.03 |  0.948 | -0.245 \\
                |              |   1268.371 |    5562.579 |  0.935 | -3.162 \\
		\hline
	\end{tabular}
	\caption{Best fit parameters for the synthetic system TTV with three perturbing planets, generated with a version of the fitting pipeline that was not working correctly.}
	\label{tab_3planetfittingparameters}
\end{table}

\begin{figure}
	\includegraphics[width=\columnwidth]{Images/TTVTestModelFittingold}
    \caption[Fitted curves for the six fitting sets for model 1 for the synthetic system, generated with broken fitting pipeline.]{Fitted TTV Curves for the six fitting sets for model 1, generated with a version of the fitting pipeline that was not working correctly, where the number of perturbing bodies and the fitting method are given. Simulated TTV times are overlaid in black.}
    \label{fig_testmodelfittingcomparisonold}
\end{figure}

We can see that some magnitudes predicted are on the order of $10^9$ seconds, and some did not generate a TTV at all.
This is clearly incorrect, and there are a few reasons as to why.

First, while the distances and times in the initial data \textit{should} have been in astronomical units and years when loaded, the simulation pipeline used metres and days. A smaller issue was seen in the parameter optimisation output, where many values for $\mu$ are zero and many values for $e$ are close to 1. To align the planets with values seen in real exoplanets, we modified the eccentricity selection to prefer lower values and defined a lower bound on $\mu$ at $10^{-9}$. As a reference, the lowest planet to star mass ratio of any discovered planet is PSR B1257+12 b at $4.092*10^{-9}$.

Additionally, many of the `best fit` solutions gave planets whose orbits are near identical. This solution, while technically satisfying the minimisation criterion, does not aptly describe physical planetary systems, and so an additional factor must be introduced when determining maximum likelihood.

\begin{equation}
    \begin{aligned}
        r_{H, min} = a \left(1-e\right) \sqrt[3]{\frac{m}{3M}} \\
        r_{H, max} = a \left(1+e\right) \sqrt[3]{\frac{m}{3M}}
    \end{aligned}
    \label{eq_hillsphere}
\end{equation}

The Hill sphere of a celestial body is the region over which it dominates the attraction of satellites, as compared to its orbital parent. The radii of the hill sphere are given in equation \ref{eq_hillsphere}, where $M$ is the mass of the primary body, and $m$, $a$, and $e$ are the mass, semi-major axis, and eccentricity of the secondary body respectively. As the extent of the hill sphere is dependent upon the distance between the body and it's parent, we require two expressions for the maximum and minimum radii. We can use this to define the boundaries of a region of instability that other planets in the system cannot cross, given in equation \ref{eq_boundary}, see equation 7 in <d-cite key="boundaryStability"></d-cite>, where $n$ is some additional term that increases the effective size of the hill sphere, as orbital perturbations in the immediate vicinity can cause bodies initially outside the boundary region to intersect with it. While this is not a strict requirement for long-term stability, as the orbits of Pluto and Neptune show, we will not consider those exoplanets with intersecting orbits.

\begin{equation}
    \begin{aligned}
        Boundary_{inner} = a \left(1-e\right)\left[1 - n\sqrt[3]{\frac{m}{3M}}\right] \\
        Boundary_{outer} = a \left(1+e\right)\left[1 + n\sqrt[3]{\frac{m}{3M}}\right]
    \end{aligned}
    \label{eq_boundary}
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusion}

The aim of this project was to increase historical transit data by observing exoplanet transits, to develop a set of analytical TTV models to approximate transit timing variation, and to create a computational pipeline for TTV analysis that should be capable of determining the best fit parameters for those models. On all three accounts, this project has been successful, with observations logged to the ExoClock database to be included in their updated ephemerides paper later this year, the models as derived in the methodology section of this paper, and a well documented codebase available in this project's GitHub repository. As mentioned in sections \ref{observations} and \ref{limitations}, only 2 transits could be observed, less than originally intended.

We have demonstrated that the analytical models are a valid descriptor for TTV signals, provided they are used within the bounds of their approximation, and that the computational pipeline is adequate for fitting those models to data. As the main programming objectives have been met, further development with the computational pipeline would focus on code optimisation and refactoring.

Although real TTV data was used to test the computational pipeline and models, no analysis was performed on them due to time constraints, especially the length of time required to fit light curves to *TESS* data when using the Gaussian process. Further research would build on this project and perform analysis of real planetary systems, as we have demonstrated the methodology to be sound.

%tc:ignore
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Acknowledgements}
\addcontentsline{toc}{section}{Acknowledgements}

I would like to thank my supervisor, Steve Futcher, for his excellent and continued guidance throughout this project. From steering me towards the ExoClock project, to providing excellent conversation through long observations at the observatory, and guidance with the work I've produced. I would also like to thank Prof. Daniel Thomas and Dr. Hooshyar Assadullahi, for their own invaluable support and guidance throughout this project, which most certainly wouldn't have been possible without the combined input of all three of my supervisors.

I would also thank the Hampshire Astronomical Group for the use of their equipment (primarily their telescopes) that not only made a large portion of this project possible, but allowed this project to be offered at all. I would also mention my thanks to the ExoClock community. Through them, I have been able to both log my own observation for the scientific community at large, and have been able to source high quality data for my own usage.

Simulations in this paper made use of the REBOUND N-body code <d-cite key="rebound"></d-cite>. The REBOUNDx package was used to incorporate additional physics <d-cite key="reboundx"></d-cite>. The simulations were integrated using IAS15, a 15th order Gauss-Radau integrator <d-cite key="reboundias15"></d-cite>.

Light curve analysis in this paper made use of the Juliet package <d-cite key="juliet"></d-cite>, which provided an interface to the following packages and methods: Transit fits were performed using Batman <d-cite key="batman"></d-cite>; Gaussian processes were performed using Celerite <d-cite key="celerite"></d-cite>; MCMC sampling was performed using Dynesty <d-cite key="dynesty"></d-cite>. Additionally, sample limb-darkening coefficients used the method outlined by Kipping et al. <d-cite key="kipping"></d-cite>, and uninformative samples for radii and impact parameters used those outlined by Espinoza et al. <d-cite key="espinoza"></d-cite>.

This research has made use of the NASA Exoplanet Archive, which is operated by the California Institute of Technology, under contract with the National Aeronautics and Space Administration under the Exoplanet Exploration Program. This paper also includes data collected with the TESS mission, obtained from the MAST data archive at the Space Telescope Science Institute (STScI). Funding for the TESS mission is provided by the NASA Explorer Program. STScI is operated by the Association of Universities for Research in Astronomy, Inc., under NASA contract NAS 5â€“26555.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Data Availability}

The datasets were derived from sources in the public domain:
\begin{itemize}
    \item[-] ExoClock -- \hyperlink{https://www.exoclock.space/}{https://www.exoclock.space/}, <d-cite key="ExoClockI"></d-cite><d-cite key="ExoClockII"></d-cite>
    \item[-] Exoplanet Archive -- \hyperlink{https://exoplanetarchive.ipac.caltech.edu/}{https://exoplanetarchive.ipac.caltech.edu/} <d-cite key="exoplanetArchive"></d-cite>.
    \item[-] Exoplanet Transit Database -- \hyperlink{https://var2.astro.cz/ETD/}{https://var2.astro.cz/ETD/} <d-cite key="ETD"></d-cite>
    \item[-] TESS MAST -- \hyperlink{https://archive.stsci.edu/missions-and-data/tess}{https://archive.stsci.edu/missions-and-data/tess} <d-cite key="tess"></d-cite>
\end{itemize}

Data for this paper were sourced from the NASA Exoplanet Archive and TESS MAST using the astroquery package <d-cite key="astroquery"></d-cite>.

Additionally, the data and software underlying this project are available in GitHub at [https://github.com/SK1Y101/TransitProject](https://github.com/SK1Y101/TransitProject).

## Appendix
<!-- 
% section header
\section{List of Figures}
\makeatletter
    % Print List of Figures
    \@starttoc{lof}
\makeatother

% section header
\section{List of Tables}
\makeatletter
    % Print List of Tables
    \@starttoc{lot}
\makeatother

## Extra material

### Transit duration derivation

As demonstrated in figure \ref{fig_transitLoc}, a transit begins the moment the planetary disk overlaps the stellar disk, reaches maximum occlusion when the centres of the star and planet are aligned, and ends once the planetary disk no longer overlaps the stellar disk. The centre-to-centre distance between the exoplanet and star at transit ingress and egress is thus the sum of their angular radii,

\begin{equation}
    s_{ingress} = s_{egress} = R_{star} + R_{planet}
\end{equation}

As a transit occurs between ingress and egress, the total angular distance the exoplanet must cover is simply twice this,

\begin{equation}
    s_{transit} = 2 R_{star} + 2 R_{planet}
\end{equation}

If we assume the exoplanets orbit is large compared to the distance travelled during a transit, this linear distance will approximately equal the distance travelled by the exoplanet during the transit. If we additionally assume the orbit of the exoplanet is circular, then the tangential velocity will remain constant,

\begin{equation}
    v = \text{const.} = \sqrt{\frac{\mu}{a}} = \sqrt{\frac{G(m_{star}+m_{planet})}{a}}
\end{equation}

The total duration of the transit in this case is given from the standard equations of motion,

\begin{equation}
    T_{transit} = \frac{s}{v} = \frac{2 R_{star} + 2 R_{planet}}{v_{planet}}
\end{equation}

Which is the expression for transit duration given in equation \ref{eq_transitduration}.

As a useful stepping stone, we instead consider the transit distance as that of a circle arc. The radius of this circle is the semi-major axis, $a$, and the angle swept by the transit, $\beta$, in radians. Thus, the transit time is given,

\begin{equation}
    T_{transit} = \frac{a \beta}{v}
\end{equation}

The swept angle, $\beta$, is also the angle swept by an isosceles triangle of base $2 R_{star} + 2 R_{planet}$ and sides $a$, as demonstrated by observing the transit from above. The angle, $\beta$, can therefore be given by the law of cosines,

\begin{equation}
    c^2 = a^2 + b^2 - 2ab\cos{\gamma}
\end{equation}

Which, if written using our orbital parameters, becomes

\begin{equation}
    \left(2 R_{star} + 2 R_{planet}\right)^2 = 2a^2(1 - \cos{\beta})
    \label{eq_start}
\end{equation}

Rearranging gives,

\begin{equation}
    1 - \cos{\beta} = \frac{\left(2 R_{star} + 2 R_{planet}\right)^2}{2a^2}
\end{equation}

This can be reformulated from trigonometric identity, $1-\cos{x} = 2\sin^2 x/2$,

\begin{equation}
    2\sin^2\frac{\beta}{2} = \frac{\left(2 R_{star} + 2 R_{planet}\right)^2}{2a^2}
\end{equation}

Which simplifies as,

\begin{equation}
    \sin\frac{\beta}{2} = \frac{R_{star} + R_{planet}}{2a}
\end{equation}

obtaining the expression for $\beta$,

\begin{equation}
    \beta = 2\arcsin{\frac{R_{star} + R_{planet}}{a}}
    \label{eq_end}
\end{equation}

Which gives the transit duration,

\begin{equation}
    T_{transit} = \frac{2 a}{v}\arcsin{\frac{R_{star} + R_{planet}}{a}}
\end{equation}

This of course exactly matches the expression given in equation \ref{eq_transitduration2}. As any given exoplanet may not transit exactly aligned with the equator of the stellar disk due to its relative inclination, the distance covered during a transit must also account for this.

There are two orbital elements that describe the orientation of a circular orbit, the inclination, $i$, and longitude of the ascending node, $\Omega$. As we do not have a defined "zero angle" for an arbitrary exoplanet, these will be described as their relative inclination, defined as zero when the planet transits the stellar equator, and relative longitude of the ascending node, defined as zero when perpendicular to our line of sight.

The offset from the stellar equator from our point of view is thus,

\begin{equation}
    b = a \cos i \sin \Omega
\end{equation}

The transverse distance of the transit is then described by a right-angled triangle of hypotenuse $ R_{star} + R_{planet}$ and height $b$, which can be recovered from Pythagorean theorem,

\begin{equation}
    s_{transverse}^2 + b^2 = \left( R_{star} + R_{planet} \right)^2
\end{equation}

which gives the transverse distance as,

\begin{equation}
    s_{transverse} = \frac{s_{transit}}{2} = \sqrt{\left( R_{star} + R_{planet} \right)^2 - b^2}
\end{equation}

following the same derivation between equations \ref{eq_start} and \ref{eq_end} gives the modified swept angle of the transit as,

\begin{equation}
    \beta_b = 2\arcsin{\frac{\sqrt{\left( R_{star} + R_{planet} \right)^2 - b^2}}{a}}
\end{equation}

Which gives a transit duration of,

\begin{equation}
    T_{transit} = \frac{2 a}{v}\arcsin{\frac{\sqrt{\left( R_{star} + R_{planet} \right)^2 - b^2}}{a}}
\end{equation}

which is of course our expression given in equation \ref{eq_transitduration3}.