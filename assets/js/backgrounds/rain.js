function drawWindow(){const t=.95*height,i=bgCtx.createLinearGradient(0,t,0,height);i.addColorStop(0,"rgba(34, 34, 34, 1)"),i.addColorStop(1,"rgba(0, 0, 0, 1)"),bgCtx.fillStyle=i,bgCtx.fillRect(0,t,width,height-t)}function lerp(t,i,e){return t+(i-t)*e}function smoothNoise(t,i,e){return.5*Math.sin(.05*t+.002*e)+.3*Math.sin(.07*i+.001*e)+.2*Math.sin(.03*(t+i)+.003*e)}function RainDrop(){this.reset()}function DripDrop(){this.reset()}function DripTrail(t,i,e,o,a){this.x=t,this.y=i,this.taily=i-e,this.length=e,this.opacity=a,this.speed=o}function RainPool(t,i){this.x=t,this.y=i,this.radius=0,this.opacity=.4}function LightningFlash(){this.timer=0,this.opacity=0}function generateLightningPath(t=10+Math.floor(5*Math.random())){const i=[];let e=.3*width+Math.random()*width*.4,o=-10;const a=(.5*height+Math.random()**2*height*.4)/t;for(let h=0;h<=t;h++)e+=80*(Math.random()-.5),o=h*a+5*Math.random(),i.push({x:e,y:o});return i}function drawLightningBolt(t){bgCtx.beginPath(),bgCtx.moveTo(t[0].x,t[0].y);for(let i=1;i<t.length-2;i++){const e=(t[i].x+t[i+1].x)/2,o=(t[i].y+t[i+1].y)/2;bgCtx.quadraticCurveTo(t[i].x,t[i].y,e,o)}const i=bgCtx.createLinearGradient(t[0].x,t[0].y,t[t.length-1].x,t[t.length-1].y);i.addColorStop(0,"rgba(255, 255, 255, 1)"),i.addColorStop(.4,"rgba(255, 255, 255, 0.7)"),i.addColorStop(.7,"rgba(255, 255, 255, 0.3)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),bgCtx.strokeStyle=i,bgCtx.lineWidth=2,bgCtx.stroke();for(let i=0;i<t.length;i++){let e=.2*(1-t.length/i)+.2;Math.random()<.5&&drawLightningFork(t[i],e)}}function drawLightningFork(t,i){const e=4+Math.floor(7*Math.random());let o=t.x,a=t.y;bgCtx.beginPath(),bgCtx.moveTo(o,a);for(let t=0;t<e;t++)o+=150*(Math.random()-.5),a+=10+40*Math.random(),bgCtx.lineTo(o,a);bgCtx.strokeStyle=`rgba(255, 255, 255, ${i})`,bgCtx.lineWidth=1,bgCtx.stroke()}function drawMug(t,i=mugX,e=mugY){t.fillStyle="#222",t.beginPath(),t.moveTo(i,e),t.lineTo(i+mugWidth,e),t.lineTo(i+mugWidth,e+mugHeight),t.lineTo(i,e+mugHeight),t.closePath(),t.fill(),t.beginPath(),t.strokeStyle="#111",t.ellipse(i+mugWidth/2,e,mugWidth/2,6,0,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="#111",t.ellipse(i+mugWidth/2,e+mugHeight,mugWidth/2,6,0,0,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="#1a0e08",t.ellipse(i+mugWidth/2,e+2,mugWidth/2*.9,4.5,0,0,2*Math.PI),t.fill();const o=i,a=e+mugHeight/2;t.beginPath(),t.strokeStyle="#222",t.lineWidth=12,t.arc(o,a,15,Math.PI/2.2,-Math.PI/2.2,!1),t.stroke()}function SteamWave(t,i){this.xBase=t,this.yBase=i,this.amplitude=5+8*Math.random(),this.opacity=.1+.1*Math.random(),this.colour="255, 255, 255"}function animate(){windTime+=.01,baseWind=2*Math.sin(.3*windTime),Math.random()<.005&&(gustTarget=4*(Math.random()-.5),gustSpeed=.01+.02*Math.random()),gust+=(gustTarget-gust)*gustSpeed,bgCtx.fillStyle="#110E19",bgCtx.fillRect(0,0,width,height),lightning.update();let t=bgCtx.createLinearGradient(0,0,0,height);t.addColorStop(0,"rgba(100, 80, 150, 0.1)"),t.addColorStop(1,"rgba(30, 20, 60, 0.3)"),bgCtx.fillRect(0,0,width,height),fogOffset+=.05,bgCtx.globalAlpha=.05,bgCtx.drawImage(fogCanvas,fogOffset%width-width,0),bgCtx.drawImage(fogCanvas,fogOffset%width,0),bgCtx.globalAlpha=1,bgCtx.filter="none";for(let t of rains)t.update();drawWindow();for(let t of drops)t.update();pools.forEach(t=>t.update()),pools=pools.filter(t=>t.opacity>0),dripTrails.forEach(t=>t.update()),dripTrails=dripTrails.filter(t=>t.opacity>0),drawMug(bgCtx,mugX,mugY),drawMug(bgCtx,secondMugX,secondMugY);for(let t of steamWaves)t.update(bgCtx,performance.now());requestAnimFrame(animate)}var requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};const background=document.getElementById("bgCanvas"),bgCtx=background.getContext("2d"),width=1920,height=1080;background.width=width,background.height=height,RainDrop.prototype.reset=function(){const t=.2,i=.5;this.x=width*(Math.random()*(t+1)-t),this.y=height*(Math.random()*(i+1)-i),this.length=20+20*Math.random(),this.speed=4+4*Math.random(),this.opacity=.1+.2*Math.random()},RainDrop.prototype.update=function(){const t=baseWind+gust;this.y+=this.speed,this.x+=.3*this.speed+.5*t,this.y+this.length+10>height&&this.reset(),this.draw()},RainDrop.prototype.draw=function(){const t=baseWind+gust,i=.3*this.speed+.5*t;bgCtx.beginPath(),bgCtx.moveTo(this.x,this.y),bgCtx.lineTo(this.x-i*(this.length/this.speed),this.y-this.length),bgCtx.strokeStyle=`rgba(255, 255, 255, ${this.opacity})`,bgCtx.lineWidth=1,bgCtx.stroke()},DripDrop.prototype.reset=function(){this.x=Math.random()*width,this.y=Math.random()*height,this.length=8+15*Math.random(),this.speed=.3+.7*Math.random(),this.opacity=.1+.15*Math.random()},DripDrop.prototype.update=function(){this.y+=this.speed;const t=height*(.96+.05*Math.random());this.y>t&&(this.x>mugX-10&&this.x<mugX+mugWidth+10?this.reset():this.x>secondMugX-10&&this.x<secondMugX+mugWidth+10?this.reset():(pools.push(new RainPool(this.x,t+2)),dripTrails.push(new DripTrail(this.x,t+2,this.length,this.speed,this.opacity)),this.reset())),this.draw()},DripDrop.prototype.draw=function(){bgCtx.beginPath(),bgCtx.moveTo(this.x,this.y),bgCtx.lineTo(this.x,this.y-this.length),bgCtx.strokeStyle=`rgba(255, 255, 255, ${this.opacity})`,bgCtx.lineWidth=2,bgCtx.stroke()},DripTrail.prototype.update=function(){if(this.y>this.taily)return;this.taily+=this.speed,this.opacity=lerp(0,this.opacity,(this.y-this.taily)/this.length);const t=bgCtx.createLinearGradient(this.x,this.y-this.length,this.x,this.y);t.addColorStop(0,"rgba(255, 255, 255, 0)"),t.addColorStop(1,`rgba(255, 255, 255, ${this.opacity})`),bgCtx.strokeStyle=t,bgCtx.lineWidth=2,bgCtx.beginPath(),bgCtx.moveTo(this.x,this.y-this.length),bgCtx.lineTo(this.x,this.y),bgCtx.stroke()},RainPool.prototype.update=function(){this.radius+=.2,this.opacity-=.002,this.draw()},RainPool.prototype.draw=function(){let t=3;for(let i=0;i<t;i++){let e=this.radius*(.6+.2*i),o=this.opacity*(1-i/t),a=3*Math.sin(.5*i+.1*this.radius);bgCtx.beginPath(),bgCtx.ellipse(this.x+a,this.y,1.3*e,.7*e,0,0,2*Math.PI),bgCtx.strokeStyle=`rgba(255, 255, 255, ${o})`,bgCtx.lineWidth=1,bgCtx.stroke()}},LightningFlash.prototype.trigger=function(){this.timer=3+Math.floor(3*Math.random()),this.opacity=.4,this.hasBolt=Math.random()<.5,this.bolt=this.hasBolt?generateLightningPath():null},LightningFlash.prototype.update=function(){Math.random()<.001&&this.timer<=0&&this.trigger(),this.timer>0&&(this.drawGlow(),this.hasBolt&&this.bolt&&drawLightningBolt(this.bolt),this.timer--)},LightningFlash.prototype.drawGlow=function(){const t=bgCtx.createLinearGradient(0,0,0,height);t.addColorStop(0,`rgba(255, 255, 255, ${.1*this.opacity})`),t.addColorStop(1,"rgba(255, 255, 255, 0)"),bgCtx.fillStyle=t,bgCtx.fillRect(0,0,width,height)};var fogCanvas=document.createElement("canvas");fogCanvas.width=width,fogCanvas.height=height;var fogCtx=fogCanvas.getContext("2d");for(let t=0;t<200;t++){let t=Math.random()*width,i=Math.random()*height,e=100+100*Math.random(),o=.01+.03*Math.random();fogCtx.beginPath(),fogCtx.arc(t,i,e,0,2*Math.PI),fogCtx.fillStyle=`rgba(255, 255, 255, ${o})`,fogCtx.fill()}const mugWidth=69,mugHeight=100,mugX=width-2*mugWidth,mugY=height-mugHeight-30,secondMugX=mugX-mugWidth-40,secondMugY=mugY+10;SteamWave.prototype.update=function(t,i){const e=6,o=20*e,a=this.yBase-o,h=Math.sin(3e-4*i+.1*this.xBase);t.beginPath();for(let s=this.yBase;s>=a;s-=e){const e=smoothNoise(this.xBase,s,i),n=this.amplitude*((s-a)/o),r=this.xBase+e*n+(s===this.yBase?0:h);t.lineTo(r,s)}const s=t.createLinearGradient(this.xBase,this.yBase,this.xBase,a);s.addColorStop(0,`rgba(${this.colour}, ${this.opacity})`),s.addColorStop(1,`rgba(${this.colour}, 0)`),t.strokeStyle=s,t.lineWidth=1,t.shadowColor=`rgba(${this.colour}, ${this.opacity})`,t.shadowBlur=4,t.stroke(),t.shadowBlur=0};let lightning=new LightningFlash,pools=[],rains=[],drops=[],dripTrails=[];const steamWaves=[];let fogOffset=0,windTime=0,baseWind=0,gust=0,gustTarget=0,gustSpeed=.03,steamCount=6;for(var i=0;i<400;i++)rains.push(new RainDrop);for(i=0;i<100;i++)drops.push(new DripDrop);for(let t=0;t<steamCount;t++)steamWaves.push(new SteamWave(lerp(mugX+2,mugX+mugWidth-2,t/steamCount),mugY));for(let t=0;t<steamCount;t++)steamWaves.push(new SteamWave(lerp(secondMugX+2,secondMugX+mugWidth-2,t/steamCount)),secondMugY);animate();